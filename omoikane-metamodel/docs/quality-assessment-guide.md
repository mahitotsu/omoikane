# 品質評価ガイド

## 概要

Omoikaneメタモデルの品質評価システムは、要件定義ドキュメントの品質を定量的・定性的に評価し、改善提案を提供します。このガイドでは、品質評価レポートの読み方、各指標の意味、推奨事項への対処方法を説明します。

## 品質評価レポートの構成

品質評価レポートは以下のセクションで構成されています：

### 1. 総合健全性スコア

```
【総合健全性スコア】
  スコア:   68/100
  レベル:   FAIR
  成熟度:   レベル3/5
```

#### スコアの意味

- **スコア (0-100点)**
  - 90-100点: **EXCELLENT** - 卓越した品質
  - 75-89点: **GOOD** - 良好な品質
  - 60-74点: **FAIR** - 許容範囲の品質
  - 45-59点: **POOR** - 改善が必要
  - 0-44点: **CRITICAL** - 重大な問題あり

- **レベル**
  - スコア範囲に基づく品質レベルの文字列表現
  - プロジェクトの現状を一目で把握できる指標

- **成熟度 (1-5段階)**
  - レベル1: **INITIAL** (初期) - 基本情報のみ存在
  - レベル2: **REPEATABLE** (反復可能) - 構造化され一貫性がある
  - レベル3: **DEFINED** (定義済み) - 詳細化され標準化されている
  - レベル4: **MANAGED** (管理済み) - 測定可能で管理されている
  - レベル5: **OPTIMIZED** (最適化) - 継続的改善が組み込まれている

### 2. 5次元成熟度評価

```
【5次元成熟度評価】
  テスト可能性     ░░░░░░░░░░░░░░░░░░░░   0.0% (0/33)
  保守性           ░░░░░░░░░░░░░░░░░░░░   0.0% (0/22)
  トレーサビリティ █████████░░░░░░░░░░░  49.5% (29/49)
  詳細度           ██████████████░░░░░░  71.7% (71/108)
  構造の完全性     ████████████████████ 100.0% (77/77)
```

#### 各次元の説明

**構造の完全性 (Structure)**
- ID、名前、基本的な構造が適切に定義されているか
- 必須フィールドが漏れなく存在するか
- 重要度: 基盤となる最重要指標

**詳細度 (Detail)**
- 説明文の充実度（文字数、具体性）
- 責務、制約、前提条件などの詳細情報
- ステップの詳細度、受け入れ基準の明確さ
- 重要度: ビジネス理解と実装精度に直結

**トレーサビリティ (Traceability)**
- ビジネス要件とユースケースの関連付け
- ビジネスゴール、ルール、ポリシーとの紐付け
- アクターとユースケースの参照関係
- 重要度: 変更影響分析と監査に必須

**テスト可能性 (Testability)**
- 受け入れ基準の明確さ
- データ要件の定義
- エラーハンドリングの記述
- バリデーションルールの具体性
- 重要度: QA効率とバグ削減に影響

**保守性 (Maintainability)**
- UI要件の記述
- 複雑度の評価
- ビジネス価値の明記
- 工数見積もりの有無
- 重要度: 長期的な開発コスト削減

#### 達成率の見方

- **80%以上**: 優れた状態、次のレベルを目指せる
- **60-79%**: 良好、いくつかの改善余地あり
- **40-59%**: 改善が必要、重点的に取り組むべき
- **40%未満**: 重大な不足、早急な対応が必要

### 3. 追加評価指標

```
【追加評価指標】
  成熟度（Maturity）:          60点 - プロジェクトの成熟度レベル（3/5を100点換算）
  完全性（Completeness）:      70点 - 全要素の基準達成率
  一貫性（Consistency）:       69点 - 次元間のバランス
  アーキテクチャ（Architecture）: 100点 - 依存関係の健全性
```

#### 各指標の計算方法

**成熟度 (Maturity)**
- 計算式: `(プロジェクトレベル / 5) × 100`
- プロジェクトレベルは全要素の最小レベル
- 意味: プロジェクト全体の最も弱い部分を示す

**完全性 (Completeness)**
- 計算式: `満たした基準数 / 全基準数 × 100`
- 重み付けを考慮した加重平均
- 意味: 定義された基準をどれだけ満たしているか

**一貫性 (Consistency)**
- 計算式: `100 - (最大次元達成率 - 最小次元達成率) × 係数`
- 5次元のバラつきを評価
- 意味: バランスの取れた開発ができているか

**アーキテクチャ (Architecture)**
- 評価項目:
  - 循環依存: 0件 = 100点
  - 孤立ノード: 0件 = 100点
  - レイヤー違反: なし = 100点
- 意味: 依存関係の健全性

### 4. 依存関係グラフ

```
【依存関係グラフ】
  ノード数: 52
  エッジ数: 130
  循環依存: 0件
  孤立ノード: 0件
```

#### 健全性の判断基準

- **循環依存**: 0件が理想（相互参照は設計の問題を示唆）
- **孤立ノード**: 0件が理想（未使用の要素を示唆）
- **エッジ/ノード比**: 2-3倍が標準的（過度に疎結合・密結合でない）

### 5. AI推奨事項

```
【AI推奨事項】
  総数: 35件
  最優先: 5件
  クイックウィン: 5件
```

#### 優先度の分類

**最優先 (high)**
- プロジェクトの成功に不可欠
- 次の成熟度レベルに必須
- 影響度の高い要素の品質問題
- 推奨工数: 通常8-40時間

**クイックウィン**
- 工数4時間以内で完了可能
- 効果が即座に表れる
- 優先的に着手すべき項目

#### 推奨事項の例

```
1. 重要要素の品質強化: reservation-business-requirements
   優先度: high
   工数: 8時間
   問題: 影響度が高い要素(入次数11, 出次数36)の品質が重要
```

**対処方法**:
1. 該当要素のファイルを開く
2. 未達成の基準を確認（レポートの詳細参照）
3. 説明の拡充、関連付けの追加など、具体的な改善を実施
4. 再評価して改善を確認

### 6. 強み・弱み

```
【強み】
  ✓ アーキテクチャ: 100点

【弱み】
  ✗ トレーサビリティ: 50点
```

#### 活用方法

**強み**
- 継続して維持すべき項目
- チームの成功パターンとして共有
- 他プロジェクトへの横展開を検討

**弱み**
- 重点的に改善すべき領域
- トレーニングや支援が必要な分野
- リソース配分の参考に

## 成熟度レベルの到達条件

各成熟度レベルに到達するには、そのレベルの**全ての必須基準**を満たす必要があります。

### レベル1: INITIAL（初期）
**アクターの必須基準:**
- ID、名前が定義されている

**ユースケースの必須基準:**
- ID、名前、説明が定義されている
- プライマリアクターが定義されている
- メインフローが1ステップ以上存在

### レベル2: REPEATABLE（反復可能）
**アクターの必須基準:**
- 説明が記述されている（1文字以上）
- 役割（role）が定義されている

**ユースケースの必須基準:**
- 説明が50文字以上
- 事前条件が1つ以上
- 事後条件が1つ以上
- メインフローが3ステップ以上
- 優先度が設定されている

### レベル3: DEFINED（定義済み）
**アクターの必須基準:**
- 責務が2つ以上リストアップされている
- 説明が30文字以上で具体的

**ユースケースの必須基準:**
- 全ステップに stepId、actor、action、expectedResult がある
- 代替フローが1つ以上定義されている
- 業務要件カバレッジが定義されている
- 受け入れ基準が1つ以上存在
- 複雑度が評価されている

### レベル4: MANAGED（管理済み）
**アクターの必須基準:**
- 少なくとも1つのユースケースで使用されている
- 説明が50文字以上で役割・責任・文脈が明確

**ユースケースの必須基準:**
- 見積工数が記録されている
- データ要件が1つ以上定義されている
- 性能要件が1つ以上存在
- セキュリティポリシーが関連付けられている
- ビジネスルールが関連付けられている

### レベル5: OPTIMIZED（最適化）
**アクターの必須基準:**
- ゴールが明確に定義されている（※未実装のためActor型拡張が必要）
- 説明が80文字以上で包括的（ビジネス文脈・セキュリティ・運用面）

**ユースケースの必須基準:**
- UI要件が1つ以上定義されている
- 全ステップにエラーハンドリングがある
- 全ステップにバリデーションルールがある
- ビジネス価値が20文字以上で明記されている

## プロジェクトレベルの決定方法

プロジェクト全体の成熟度レベルは、**全要素（アクター、ユースケース、業務要件）の最小レベル**で決定されます。

### 計算例

```
アクター:
- visitor: レベル4
- storeStaff: レベル4
- capacityPlanner: レベル3  ← 最小
- systemAdmin: レベル4

ユースケース:
- reservation-booking: レベル3
- reservation-cancel: レベル3
- (その他すべてレベル3以上)

→ プロジェクトレベル = min(3, 3, ...) = レベル3
```

この方式により、プロジェクトの**最も弱い部分**が明確になり、改善の優先順位付けが容易になります。

## 次のステップ

品質評価レポートを活用して改善を進めるには：

1. **現状理解**: 総合スコアとレベルで全体像を把握
2. **優先順位付け**: クイックウィンと最優先推奨事項を確認
3. **具体的な改善**: 弱みの次元を重点的に改善
4. **継続的評価**: 定期的に品質評価を実行し、改善を追跡
5. **チーム共有**: レポートをチーム全体で共有し、品質意識を向上

詳細な改善方法については、[推奨事項対処ガイド](./recommendations-guide.md)を参照してください。
